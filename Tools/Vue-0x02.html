<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue $dispatch å’Œ $broadcast | LittleLane</title>
    <meta name="description" content="LittleLaneçš„åšå®¢">
    <link rel="manifest" href="/blog/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.fb084c9e.css" as="style"><link rel="preload" href="/blog/assets/js/app.8628b115.js" as="script"><link rel="preload" href="/blog/assets/js/37.13db91e9.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.7c696101.js"><link rel="prefetch" href="/blog/assets/js/11.0789c73b.js"><link rel="prefetch" href="/blog/assets/js/12.461a1f52.js"><link rel="prefetch" href="/blog/assets/js/13.fe3225de.js"><link rel="prefetch" href="/blog/assets/js/14.90707970.js"><link rel="prefetch" href="/blog/assets/js/15.fe5adc74.js"><link rel="prefetch" href="/blog/assets/js/16.0ebb9344.js"><link rel="prefetch" href="/blog/assets/js/17.9ccc244d.js"><link rel="prefetch" href="/blog/assets/js/18.3280c375.js"><link rel="prefetch" href="/blog/assets/js/19.497df057.js"><link rel="prefetch" href="/blog/assets/js/2.a2883561.js"><link rel="prefetch" href="/blog/assets/js/20.32678c14.js"><link rel="prefetch" href="/blog/assets/js/21.1423f536.js"><link rel="prefetch" href="/blog/assets/js/22.f2e999a8.js"><link rel="prefetch" href="/blog/assets/js/23.ba5456dd.js"><link rel="prefetch" href="/blog/assets/js/24.506605c5.js"><link rel="prefetch" href="/blog/assets/js/25.a207ec0f.js"><link rel="prefetch" href="/blog/assets/js/26.2ef516a2.js"><link rel="prefetch" href="/blog/assets/js/27.0fc3d0a8.js"><link rel="prefetch" href="/blog/assets/js/28.857b9f54.js"><link rel="prefetch" href="/blog/assets/js/29.ddc54fa4.js"><link rel="prefetch" href="/blog/assets/js/3.03546f42.js"><link rel="prefetch" href="/blog/assets/js/30.d40e6ea0.js"><link rel="prefetch" href="/blog/assets/js/31.1195eb55.js"><link rel="prefetch" href="/blog/assets/js/32.8de16a5a.js"><link rel="prefetch" href="/blog/assets/js/33.7cd7fe57.js"><link rel="prefetch" href="/blog/assets/js/34.738f5bc5.js"><link rel="prefetch" href="/blog/assets/js/35.77dd47e7.js"><link rel="prefetch" href="/blog/assets/js/36.352ec5b1.js"><link rel="prefetch" href="/blog/assets/js/38.c6fc1157.js"><link rel="prefetch" href="/blog/assets/js/39.8c2096af.js"><link rel="prefetch" href="/blog/assets/js/4.230e5792.js"><link rel="prefetch" href="/blog/assets/js/40.b2aa99ad.js"><link rel="prefetch" href="/blog/assets/js/41.b6c8edd8.js"><link rel="prefetch" href="/blog/assets/js/42.44ad0cc7.js"><link rel="prefetch" href="/blog/assets/js/43.fb6bd8dc.js"><link rel="prefetch" href="/blog/assets/js/44.f45a0bfd.js"><link rel="prefetch" href="/blog/assets/js/45.3ac2cc18.js"><link rel="prefetch" href="/blog/assets/js/46.763aa6cb.js"><link rel="prefetch" href="/blog/assets/js/47.949030e9.js"><link rel="prefetch" href="/blog/assets/js/48.54ad9db1.js"><link rel="prefetch" href="/blog/assets/js/5.e8583280.js"><link rel="prefetch" href="/blog/assets/js/6.34b724f6.js"><link rel="prefetch" href="/blog/assets/js/7.1c9ebf74.js"><link rel="prefetch" href="/blog/assets/js/8.928845ca.js"><link rel="prefetch" href="/blog/assets/js/9.aac799a8.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.fb084c9e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">LittleLane</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/AboutMe/" class="nav-link">å…³äºæˆ‘</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/AboutMe/" class="nav-link">å…³äºæˆ‘</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="carbon-ads"></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/JavaScript/0x00.html" class="sidebar-link">å‡½æ•°ä¸€ç­‰å…¬æ°‘</a></li><li><a href="/blog/JavaScript/0x01.html" class="sidebar-link">å›è°ƒå‡½æ•°è¯¦è§£</a></li><li><a href="/blog/JavaScript/0x02.html" class="sidebar-link">é«˜é˜¶å‡½æ•°</a></li><li><a href="/blog/JavaScript/0x03.html" class="sidebar-link">é‡å­¦ new æ“ä½œç¬¦</a></li><li><a href="/blog/JavaScript/0x04.html" class="sidebar-link">é‡å­¦ callã€apply</a></li><li><a href="/blog/JavaScript/0x05.html" class="sidebar-link">é‡å­¦ bind</a></li><li><a href="/blog/JavaScript/0x06.html" class="sidebar-link">é‡å­¦ Array ä¹‹åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/blog/JavaScript/0x07.html" class="sidebar-link">é‡å­¦ Array ä¹‹å…ƒç´ å¢åˆ </a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DSA</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Node.js</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Tools</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/Tools/Vue-0x00.html" class="sidebar-link">Vue ç»„ä»¶é€šä¿¡è¯¦è§£</a></li><li><a href="/blog/Tools/Vue-0x01.html" class="sidebar-link">v-model å®ç°åŸç†</a></li><li><a href="/blog/Tools/Vue-0x02.html" class="active sidebar-link">Vue $dispatch å’Œ $broadcast</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Tools/Vue-0x02.html#_00-å‰è¨€" class="sidebar-link">00 å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/blog/Tools/Vue-0x02.html#_01-dispatch-è¯¦è§£" class="sidebar-link">01 $dispatch è¯¦è§£</a></li><li class="sidebar-sub-header"><a href="/blog/Tools/Vue-0x02.html#_10-broadcast-è¯¦è§£" class="sidebar-link">10 $broadcast è¯¦è§£</a></li><li class="sidebar-sub-header"><a href="/blog/Tools/Vue-0x02.html#_11-æ€»ç»“" class="sidebar-link">11 æ€»ç»“</a></li></ul></li><li><a href="/blog/Tools/Vue-0x03.html" class="sidebar-link">Vue v-model æºç è§£æ</a></li><li><a href="/blog/Tools/Vue-0x04.html" class="sidebar-link">v-model åç»­ input and change</a></li><li><a href="/blog/Tools/Vue-0x05.html" class="sidebar-link">Vue ç”Ÿå‘½å‘¨æœŸè¯¦è§£</a></li><li><a href="/blog/Tools/Vue-0x06.html" class="sidebar-link">Vue.use() åšäº†ä»€ä¹ˆï¼Ÿ</a></li><li><a href="/blog/Tools/Vue-0x07.html" class="sidebar-link">Vue Router å®ç°å‰–æä¹‹ä¸€</a></li><li><a href="/blog/Tools/Vue-0x08.html" class="sidebar-link">Vue Router å®ç°å‰–æä¹‹äºŒ</a></li><li><a href="/blog/Tools/Vue-0x09.html" class="sidebar-link">Vue Router å®ç°å‰–æä¹‹ä¸‰</a></li><li><a href="/blog/Tools/Vue-0x0A.html" class="sidebar-link">Vue Router å®ç°å‰–æä¹‹äº”</a></li><li><a href="/blog/Tools/Vue-0x0B.html" class="sidebar-link">æ•°æ®å“åº”å¼åˆæ¢</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DailyQuestion</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/DailyQuestion/0x00.html" class="sidebar-link">['1', '2', '3'].map(parseInt)</a></li><li><a href="/blog/DailyQuestion/0x01.html" class="sidebar-link">git ssh Permission denied</a></li><li><a href="/blog/DailyQuestion/0x02.html" class="sidebar-link">0.1 + 0.2 !== 0.3</a></li><li><a href="/blog/DailyQuestion/0x03.html" class="sidebar-link">èŠèŠ a æ ‡ç­¾ rel å±æ€§å€¼</a></li><li><a href="/blog/DailyQuestion/0x04.html" class="sidebar-link">æµè§ˆå™¨è·¯ç”± API è¯¦è§£</a></li><li><a href="/blog/DailyQuestion/0x05.html" class="sidebar-link">VSCode nvm é—®é¢˜</a></li><li><a href="/blog/DailyQuestion/0x06.html" class="sidebar-link">æ¶‰åŠ new ã€thisã€ä»¥åŠåŸå‹é“¾ç»å…¸ä¹ é¢˜</a></li><li><a href="/blog/DailyQuestion/0x07.html" class="sidebar-link">DBeaver MySQL é—®é¢˜é›†</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>BestPractices</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>SafeOptimize</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/SafeOptimize/0x00.html" class="sidebar-link">JavaScript åŠ è½½ä¸æ‰§è¡Œ</a></li><li><a href="/blog/SafeOptimize/0x01.html" class="sidebar-link">å‡½æ•°èŠ‚æµ</a></li><li><a href="/blog/SafeOptimize/0x02.html" class="sidebar-link">XSSï¼ˆCross-Site Scriptingï¼‰</a></li><li><a href="/blog/SafeOptimize/0x03.html" class="sidebar-link">CSRF(Cross-Site Request Forgery)</a></li><li><a href="/blog/SafeOptimize/0x04.html" class="sidebar-link">æ·±å…¥å‡½æ•°èŠ‚æµ</a></li><li><a href="/blog/SafeOptimize/0x05.html" class="sidebar-link">js å¼‚æ­¥åŠ è½½ä¹‹ async å’Œ defer</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="vue-dispatch-å’Œ-broadcast"><a href="#vue-dispatch-å’Œ-broadcast" aria-hidden="true" class="header-anchor">#</a> Vue $dispatch å’Œ $broadcast</h1> <p><a name="70761d53"></a></p> <h2 id="_00-å‰è¨€"><a href="#_00-å‰è¨€" aria-hidden="true" class="header-anchor">#</a> 00 å‰è¨€</h2> <p>$dispatch å’Œ $broadcast ä½œä¸ºä¸€å¯¹æƒ…ä¾£ ğŸ’‘å±æ€§ï¼Œåœ¨ Vue 1.0 ä¸­ä¸»è¦ç”¨æ¥å®ç°åŸºäºç»„ä»¶æ ‘ç»“æ„çš„äº‹ä»¶æµé€šä¿¡ â€”â€” é€šè¿‡å‘ä¸Šæˆ–å‘ä¸‹ä»¥å†’æ³¡çš„å½¢å¼ä¼ é€’äº‹ä»¶æµï¼Œä»¥å®ç°åµŒå¥—çˆ¶å­ç»„ä»¶çš„é€šä¿¡ã€‚ä½†æ˜¯ç”±äºå…¶æ˜¾åŠŸèƒ½ç¼ºé™·ï¼Œåœ¨ Vue 2.0 ä¸­å°±è¢«ç§»é™¤äº†ã€‚è™½ç„¶ Vue å®˜ç½‘å·²ç»ä¸å†æ”¯æŒä½¿ç”¨Â $dispatch å’Œ $broadcast è¿›è¡Œç»„ä»¶é€šä¿¡ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šåŸºäº Vue çš„ UI æ¡†æ¶ä¸­éƒ½æœ‰å¯¹å…¶çš„å°è£…ï¼ŒåŒ…æ‹¬ <a href="http://element-cn.eleme.io/#/zh-CN" target="_blank" rel="noopener noreferrer"><strong>element-ui</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://github.com/iview/iview" target="_blank" rel="noopener noreferrer">iview<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>Â ç­‰ç­‰ã€‚</p> <p>é‚£ä¹ˆÂ $dispatch å’Œ $broadcast åˆ°åº•æ˜¯æ€ä¹ˆå·¥ä½œï¼Œå…¶åº•å±‚åˆæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¯¦ç»†çš„è¯´ä¸€è¯´ï¼</p> <p><a name="175d38a3"></a></p> <h2 id="_01-dispatch-è¯¦è§£"><a href="#_01-dispatch-è¯¦è§£" aria-hidden="true" class="header-anchor">#</a> 01 $dispatch è¯¦è§£</h2> <p>ä¸ºäº†è¿½æ ¹æº¯æºï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆå» Vue 1.0 çš„æ–‡æ¡£ä½ è§‚æ‘©ä¸€ä¸‹å…¶æ¦‚å¿µå§ï¼</p> <blockquote><p><strong>æ¦‚å¿µï¼š</strong></p></blockquote> <p><em><strong>Dispatch an event, first triggering it on the instance itself, and then propagates upward along the parent chain. The propagation stops when it triggers a parent event listener, unless that listener returnsÂ <strong><strong><code>true</code></strong></strong>. Any additional arguments will be passed into the listenerâ€™s callback function.</strong><br></em><br>ä¸Šé¢çš„ä¸€æ®µè‹±æ–‡å®šä¹‰æ¥è‡ª Vue 1.0 å®˜æ–¹æ–‡æ¡£ï¼Œå…¶å¤§è‡´çš„æ„æ€æ˜¯è¯´ï¼š<strong>dispatch æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œé¦–å…ˆä¼šåœ¨è‡ªå·±å®ä¾‹æœ¬èº«ä¸Šè§¦å‘ï¼Œç„¶åæ²¿çˆ¶é“¾å‘ä¸Šä¼ æ’­ã€‚å½“å®ƒè§¦å‘çˆ¶ç»„ä»¶ä¸Šçš„äº‹ä»¶ä¾¦å¬å™¨æ—¶ä¼ æ’­å³ä¼šåœæ­¢ï¼Œé™¤éè¯¥ä¾¦å¬å™¨è¿”å› trueã€‚ ä»»ä½•å…¶ä»–å‚æ•°éƒ½å°†ä¼ é€’ç»™ä¾¦å¬å™¨çš„å›è°ƒå‡½æ•°ã€‚</strong></p> <blockquote><p><strong>å‚æ•°ï¼š</strong></p></blockquote> <p>dispatch ä¼šæ¥æ”¶ä¸¤ä¸­å‚æ•°ï¼ševent æ˜¯äº‹ä»¶åç§°ï¼Œ[...args] æ˜¯è§¦å‘äº‹ä»¶æ—¶ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p> <blockquote><p><strong>ä¾‹å­ï¼š</strong></p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// åˆ›å»ºä¸€ä¸ª parent ç»„ä»¶</span>
<span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»ºä¸€ä¸ª child1 ç»„ä»¶ï¼Œå…¶çˆ¶ç»„ä»¶æŒ‡å‘ parent</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> parent<span class="token punctuation">:</span> parent <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»ºä¸€ä¸ª child2 ç»„ä»¶ï¼Œå…¶çˆ¶ç»„ä»¶æŒ‡å‘ child1</span>
<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> parent<span class="token punctuation">:</span> child1 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨ parent ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
parent<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'parent notified'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨ child1 ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
child1<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child1 notified'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨ child2 ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
child2<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child2 notified'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¯´åˆ°è¿™é‡Œï¼Œparentã€child1Â å’ŒÂ child2 ä¸‰ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»å¯ä»¥å±•ç¤ºæˆå¦‚ä¸‹çš„å…³ç³»å›¾ï¼š<br> <img src="https://cdn.nlark.com/yuque/0/2019/png/114852/1551870035081-a5c673d4-9ed2-4e31-96b2-343c54c0b449.png#align=left&display=inline&height=362&name=%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%20%284%29.png&originHeight=370&originWidth=194&size=4444&status=done&width=190" alt="é«˜é˜¶ç»„ä»¶ (4).png"><br></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// åœ¨ child2 ç»„ä»¶ä¸­é€šè¿‡ dispatch è§¦å‘ test äº‹ä»¶</span>
child2<span class="token punctuation">.</span><span class="token function">$dispatch</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// äº‹ä»¶æ‰§è¡Œä¼šè¾“å‡ºå¦‚ä¸‹ç»“æœ</span>
<span class="token comment">// -&gt; &quot;child2 notified&quot;</span>
<span class="token comment">// -&gt; &quot;child1 notified&quot;</span>
</code></pre></div><p>å½“æ‰§è¡ŒÂ child2.$dispatch('test'); æ—¶ï¼Œé¦–å…ˆä¼šè§¦å‘ child2 ç»„ä»¶é‡Œé¢ç›‘å¬çš„ test äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œè¾“å‡ºÂ 'child2 notified'ï¼Œæ ¹æ®ä¸Šé¢å®˜æ–¹æ–‡æ¡£çš„å®šä¹‰ï¼Œäº‹ä»¶ä¼šæ²¿ç€ç»„ä»¶å…³ç³»é“¾ä¸€ç›´å‘ä¸Šä¼ é€’ï¼Œç„¶åä¼ é€’åˆ° child1 ç»„ä»¶ï¼Œè§¦å‘ç›‘å¬äº‹ä»¶è¾“å‡ºÂ &quot;child1 notified&quot;ï¼Œä½†æ˜¯è¯¥ä¾¦å¬å™¨æ²¡æœ‰è¿”å› trueï¼Œæ‰€ä»¥äº‹ä»¶ä¼ é€’åˆ°æ­¤å°±ç»“æŸäº†ï¼Œæœ€ç»ˆçš„è¾“å‡ºç»“æœå°±åªæœ‰Â &quot;child2 notified&quot; å’ŒÂ &quot;child1 notified&quot;ã€‚</p> <blockquote><p><strong>Vue 1.0 å®˜æ–¹å®ç°</strong></p></blockquote> <p>åœ¨ Vue 1.0 ç‰ˆæœ¬ä¸­ï¼Œ$dispatch å®ç°çš„æºç æ”¾åœ¨Â /src/instance/api/events.js æ–‡ä»¶ä¸­ï¼Œä»£ç å¾ˆç®€å•ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * Recursively propagate an event up the parent chain.
 * é€’å½’åœ°åœ¨çˆ¶é“¾ä¸Šä¼ æ’­äº‹ä»¶ã€‚
 * @param {String} event
 * @param {...*} additional arguments
 */</span>
<span class="token comment">// $dispatch æ–¹æ³•æ˜¯å®šä¹‰åœ¨ Vue çš„ prototype ä¸Šçš„</span>
<span class="token comment">// æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„äº‹ä»¶åç§°</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$dispatch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// é¦–å…ˆæ‰§è¡Œ $emit è§¦å‘äº‹ä»¶ï¼Œå°†è¿”å›å€¼ä¿å­˜åœ¨ shouldPropagate ä¸­</span>
  <span class="token keyword">var</span> shouldPropagate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  
  <span class="token comment">// å¦‚æœé¦–æ¬¡æ‰§è¡Œçš„ $emit æ–¹æ³•è¿”å›çš„å€¼ä¸æ˜¯ true å°±ç›´æ¥è¿”å›</span>
  <span class="token comment">// å¦‚æœè¿”å›å€¼ä¸æ˜¯ true å°±è¯´æ˜ç»„ä»¶é€»è¾‘ä¸å¸Œæœ›äº‹ä»¶ç»§ç»­å¾€çˆ¶ç»„ä»¶è¿›è¡Œä¼ é€’</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>shouldPropagate<span class="token punctuation">)</span> <span class="token keyword">return</span>
  
  <span class="token comment">// å¦‚æœé¦–æ¬¡æ‰§è¡Œ $emit æ–¹æ³•è¿”å›å€¼æ˜¯ true å°±è·å–å½“å‰ç»„ä»¶çš„ parent ç»„ä»¶å®ä¾‹</span>
  <span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent
  
  <span class="token comment">// å°†å‡½æ•°æ¥å—çš„å‚æ•°è½¬æ¢æˆæ•°ç»„</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token function">toArray</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
  
  <span class="token comment">// use object event to indicate non-source emit on parents</span>
  <span class="token comment">// æ ¹æ®ä¼ å…¥çš„äº‹ä»¶åç§°çš„å‚æ•°ç»„è£…æˆ object</span>
  args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> event<span class="token punctuation">,</span> source<span class="token punctuation">:</span> <span class="token keyword">this</span> <span class="token punctuation">}</span>
  
  <span class="token comment">// å¾ªç¯çŸ¥é“ç»„ä»¶çš„çˆ¶ç»„ä»¶</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åœ¨çˆ¶ç»„ä»¶ä¸­æ‰§è¡Œ $emit è§¦å‘äº‹ä»¶</span>
    shouldPropagate <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    
    <span class="token comment">// å¦‚æœçˆ¶ç»„ä»¶ $emit è¿”å›çš„æ˜¯ true å°±ç»§ç»­é€’å½’ç¥–çˆ¶ç»„ä»¶ï¼Œå¦åˆ™å°±åœæ­¢å¾ªç¯</span>
    parent <span class="token operator">=</span> shouldPropagate <span class="token operator">?</span> parent<span class="token punctuation">.</span>$parent <span class="token punctuation">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// æœ€åè¿”å›å½“å‰ç»„ä»¶å®ä¾‹</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>element-ui å®ç°</strong></p></blockquote> <p>åœ¨ Element-UI ä¸­ï¼Œ$dispatch å®ç°çš„æºç æ”¾åœ¨Â /src/mixins/emitter.js æ–‡ä»¶ä¸­ï¼Œä»£ç å¾ˆç®€å•ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// å®šä¹‰ dispatch æ–¹æ³•ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šç»„ä»¶åç§°ã€å°†è¦è§¦å‘çš„äº‹ä»¶åç§°ã€å›è°ƒå‡½æ•°ä¼ é€’çš„å‚æ•°</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–åŸºäºå½“å‰ç»„ä»¶çš„çˆ¶ç»„ä»¶å®ä¾‹ï¼Œè¿™é‡Œå¯¹çˆ¶ç»„ä»¶å®ä¾‹å’Œæ ¹ç»„ä»¶å®ä¾‹åšäº†å…¼å®¹å¤„ç†</span>
  <span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$root<span class="token punctuation">;</span>
  
  <span class="token comment">// é€šè¿‡çˆ¶ç»„ä»¶çš„ $option å±æ€§è·å–ç»„ä»¶çš„åç§°</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>componentName<span class="token punctuation">;</span>

  <span class="token comment">// å½“ç›¸å¯¹å½“å‰ç»„ä»¶çš„çˆ¶ç»„ä»¶å®ä¾‹å­˜åœ¨ï¼Œè€Œä¸”å½“çˆ¶ç»„ä»¶çš„åç§°ä¸å­˜åœ¨æˆ–è€…çˆ¶ç»„ä»¶çš„åç§°ä¸ç­‰äºä¼ å…¥çš„ç»„ä»¶åç§°æ—¶ï¼Œæ‰§è¡Œå¾ªç¯</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> name <span class="token operator">!==</span> componentName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®°å½•çˆ¶ç»„ä»¶çš„çˆ¶ç»„ä»¶</span>
    parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>$parent<span class="token punctuation">;</span>

    <span class="token comment">// å½“çˆ¶ç»„ä»¶çš„çˆ¶ç»„ä»¶å­˜åœ¨æ—¶ï¼Œè·å–ç¥–çˆ¶ç»„ä»¶çš„åç§°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      name <span class="token operator">=</span> parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>componentName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// å½“å¾ªç¯ç»“æŸæ˜¯ï¼Œparent çš„å€¼å°±æ˜¯æœ€ç»ˆåŒ¹é…çš„ç»„ä»¶å®ä¾‹</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å½“ parent å€¼å­˜åœ¨æ—¶è°ƒç”¨ $emit æ–¹æ³•</span>
    <span class="token comment">// ä¼ å…¥ parent å®ä¾‹ã€äº‹ä»¶åç§°ä¸ params å‚æ•°ç»„æˆçš„æ•°ç»„</span>
    <span class="token comment">// è§¦å‘ä¼ å…¥äº‹ä»¶åç§° eventName åŒåçš„äº‹ä»¶</span>
    parent<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> <span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>å·®å¼‚åˆ†æ</strong></p></blockquote> <p>ä»”ç»†çœ‹å®Œå®ç° $dispatch æ–¹å¼çš„ä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç ï¼Œå¤§å®¶æ˜¯ä¸æ˜¯å‘ç°ï¼Œä¸¤ä¸ªç‰ˆæœ¬çš„å®ç°å’ŒåŠŸèƒ½å·®å¼‚æ€§è¿˜æ˜¯å¾ˆå¤§çš„ã€‚</p> <ul><li><p>1ã€æ¥å—å‚æ•°ï¼šVue å®ç°ç‰ˆæœ¬åªä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„äº‹ä»¶åç§°ä¸ºå‚æ•°ï¼Œè€Œ element-ui å®ç°çš„ç‰ˆæœ¬ä¼šæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šéœ€è¦è§¦å‘äº‹ä»¶çš„ç»„ä»¶åç§°ã€å°†è¦è§¦å‘çš„äº‹ä»¶åç§°ã€å›è°ƒå‡½æ•°ä¼ é€’çš„å‚æ•°ï¼›</p></li> <li><p>2ã€å®ç°åŠŸèƒ½ï¼šVue å®ç°ç‰ˆæœ¬è§¦å‘äº‹ä»¶ä¸€ç›´ä¼šé¡ºç€ç»„ä»¶é“¾å‘ä¸Šè¿›è¡Œä¼ é€’ï¼ŒçŸ¥é“çˆ¶ç»„ä»¶ä¸­çš„ä¾¦å¬å™¨æ²¡æœ‰è¿”å› trueï¼Œåœ¨è¿™ä¸ªæœŸé—´æ‰€æœ‰çš„ç»„ä»¶éƒ½ä¼šæ‰§è¡Œäº‹ä»¶çš„å“åº”ï¼ŒåŒ…æ‹¬å½“å‰ç»„ä»¶æœ¬èº«ï¼Œè€Œ element-ui å®ç°ç‰ˆæœ¬ä¼šä¸æ–­çš„åŸºäºå½“å‰ç»„ä»¶å‘çˆ¶ç»„ä»¶è¿›è¡Œéå†ï¼Œç›´è‡³æ‰¾åˆ°å’Œæ¥å—çš„ç»„ä»¶åç§°åŒ¹é…ï¼Œå°±ä¼šåœæ­¢éå†ï¼Œè§¦å‘åŒ¹é…ç»„ä»¶ä¸­çš„ç›‘å¬äº‹ä»¶ã€‚</p></li></ul> <p><a name="3d7550fe"></a></p> <h2 id="_10-broadcast-è¯¦è§£"><a href="#_10-broadcast-è¯¦è§£" aria-hidden="true" class="header-anchor">#</a> 10 $broadcast è¯¦è§£</h2> <p>ä¸Šé¢è¯¦ç»†çš„è¯´å®Œ $dispatch æ–¹æ³•çš„å®ç°å’Œ Vue å®ç°ç‰ˆæœ¬ä¸ element-ui å®ç°ç‰ˆæœ¬çš„åŒºåˆ«ï¼Œä¸‹é¢å°±è¯¥è¯´è¯´ $broadcastï¼Œæ¯•ç«Ÿä»–ä»¬æ˜¯æƒ…ä¾£å±æ€§å˜›ã€‚</p> <blockquote><p><strong>æ¦‚å¿µ</strong></p></blockquote> <p><em>Broadcast an event that propagates downward to all descendants of the current instance. Since the descendants expand into multiple sub-trees, the event propagation will follow many different â€œpathsâ€. The propagation for each path will stop when a listener callback is fired along that path, unless the callback returnsÂ <em><code>_true_</code></em><strong>.</strong></em><br><br>Broadcast æ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå®ƒå‘ä¸‹ä¼ æ’­åˆ°å½“å‰å®ä¾‹çš„æ‰€æœ‰åä»£ã€‚ç”±äºåä»£æ‰©å±•ä¸ºå¤šä¸ªå­æ ‘ï¼Œäº‹ä»¶ä¼ æ’­å°†ä¼šéµå¾ªè®¸å¤šä¸åŒçš„â€œè·¯å¾„â€ã€‚ é™¤éå›è°ƒè¿”å› trueï¼Œå¦åˆ™åœ¨æ²¿è¯¥è·¯å¾„è§¦å‘ä¾¦å¬å™¨å›è°ƒæ—¶ï¼Œæ¯ä¸ªè·¯å¾„çš„ä¼ æ’­å°†ä¼šåœæ­¢ã€‚</p> <blockquote><p><strong>å‚æ•°</strong></p></blockquote> <p><br>broadcast ä¼šæ¥æ”¶ä¸¤ä¸­å‚æ•°ï¼ševent æ˜¯äº‹ä»¶åç§°ï¼Œ[...args] æ˜¯è§¦å‘äº‹ä»¶æ—¶ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p> <blockquote><p><strong>ä¾‹å­</strong></p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// åˆ›å»º parent ç»„ä»¶å®ä¾‹</span>
<span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åˆ›å»º child1 ç»„ä»¶å®ä¾‹ï¼Œå…¶çˆ¶ç»„ä»¶æŒ‡å‘ parent</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> parent<span class="token punctuation">:</span> parent <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åˆ›å»º child2 ç»„ä»¶å®ä¾‹ï¼Œå…¶çˆ¶ç»„ä»¶æŒ‡å‘ parent</span>
<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> parent<span class="token punctuation">:</span> parent <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åˆ›å»º child3 ç»„ä»¶å®ä¾‹ï¼Œå…¶çˆ¶ç»„ä»¶æŒ‡å‘ child2</span>
<span class="token keyword">var</span> child3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> parent<span class="token punctuation">:</span> child2 <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨ child1 ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
child1<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child1 notified'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨ child2 ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
child2<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child2 notified'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨ child3 ç»„ä»¶ç›‘å¬åä¸º test çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
child3<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child3 notified'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>parentã€child1ã€child2 å’Œ child3 å››ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»å¯ä»¥å±•ç¤ºæˆå¦‚ä¸‹çš„å…³ç³»å›¾ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2019/png/114852/1551875942057-18c8899a-6c5c-4015-a4f7-38f2e755dcc1.png#align=left&display=inline&height=363&name=%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%20%285%29.png&originHeight=399&originWidth=345&size=8819&status=done&width=314" alt="é«˜é˜¶ç»„ä»¶ (5).png"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>parent<span class="token punctuation">.</span><span class="token function">$broadcast</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span>
<span class="token comment">// -&gt; &quot;child1 notified&quot;</span>
<span class="token comment">// -&gt; &quot;child2 notified&quot;</span>
</code></pre></div><p>å½“æ‰§è¡ŒÂ parent.$broadcast('test'); æ—¶ï¼Œäº‹ä»¶æµä¼šä»¥ parent ç»„ä»¶ä¸ºèµ·ç‚¹å‘ parent çš„å­ç»„ä»¶è¿›è¡Œä¼ é€’ï¼Œæ ¹æ®äº‹ä»¶ç»‘å®šçš„é¡ºåºï¼Œè™½ç„¶ parent ç»„ä»¶æœ‰ä¸¤ä¸ªåŒçº§çš„ child1 å’Œ child2 ï¼Œä½†æ˜¯äº‹ä»¶æµä¼šå…ˆè§¦å‘ child1 é‡Œé¢çš„ç»‘å®šäº‹ä»¶ï¼Œæ­¤æ—¶ä¼šè¾“å‡º &quot;child1 notified&quot;ï¼Œç„¶åäº‹ä»¶æµåˆ°è¾¾ child2 ç»„ä»¶ï¼Œä¼šè§¦å‘ child2 ç»„ä»¶ä¸­çš„ç»‘å®šäº‹ä»¶ï¼Œè¾“å‡º &quot;child2 notified&quot;ã€‚åˆ°è¿™æ—¶ï¼Œchild2 ç»„ä»¶ä¸­çš„ä¾¦å¬å™¨å¹¶æ²¡æœ‰è¿”å› trueï¼Œæ‰€ä»¥äº‹ä»¶ä¼ é€’åˆ°æ­¤å°±ç»“æŸäº†ï¼Œæœ€ç»ˆçš„è¾“å‡ºç»“æœå°±åªæœ‰Â &quot;child1 notified&quot; å’ŒÂ &quot;child2 notified&quot;ã€‚</p> <blockquote><p><strong>Vue 1.0 å®˜æ–¹å®ç°</strong></p></blockquote> <p><br>åœ¨ Vue 1.0 ç‰ˆæœ¬ä¸­ï¼Œ$broadcast å®ç°çš„æºç æ”¾åœ¨Â /src/instance/api/events.js æ–‡ä»¶ä¸­ï¼Œä»£ç å¾ˆç®€å•ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * Recursively broadcast an event to all children instances.
 * é€’å½’åœ°å‘æ‰€æœ‰å­å®ä¾‹å¹¿æ’­äº‹ä»¶ã€‚
 * @param {String|Object} event
 * @param {...*} additional arguments
 */</span>
<span class="token comment">// $dispatch æ–¹æ³•æ˜¯å®šä¹‰åœ¨ Vue çš„ prototype ä¸Šçš„</span>
<span class="token comment">// æ¥å—ä¸€ä¸ªäº‹ä»¶</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$broadcast</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–ä¼ å…¥äº‹ä»¶çš„ç±»å‹ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå­—ç¬¦ä¸²</span>
  <span class="token keyword">var</span> isSource <span class="token operator">=</span> <span class="token keyword">typeof</span> event <span class="token operator">===</span> <span class="token string">'string'</span>
  
  <span class="token comment">// æ ¡æ­£ event çš„å€¼ï¼Œå½“æ¥å— event çš„ç±»å‹ä¸ºå­—ç¬¦ä¸²æ—¶å°±ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœä¸æ˜¯å­—ç¬¦ä¸²å°±ä½¿ç”¨ event ä¸Šçš„ name å±æ€§ </span>
  event <span class="token operator">=</span> isSource <span class="token operator">?</span> event <span class="token punctuation">:</span> event<span class="token punctuation">.</span>name
  
  <span class="token comment">// if no child has registered for this event,</span>
  <span class="token comment">// then there's no need to broadcast.</span>
  <span class="token comment">// å¦‚æœå½“å‰ç»„ä»¶çš„å­ç»„ä»¶æ²¡æœ‰æ³¨å†Œè¯¥äº‹ä»¶ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¹¶ä¸ç”¨ broadcast</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>_eventsCount<span class="token punctuation">[</span>event<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
  
  <span class="token comment">// è·å–å½“å‰ç»„ä»¶çš„å­ç»„ä»¶</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$children
  
  <span class="token comment">// å°†å‡½æ•°æ¥å—çš„å‚æ•°è½¬æ¢æˆæ•°ç»„</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token function">toArray</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
  
  <span class="token comment">// å¦‚æœä¼ å…¥äº‹ä»¶ä¸ºå­—ç¬¦ä¸²</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// use object event to indicate non-source emit</span>
    <span class="token comment">// on children</span>
    <span class="token comment">// æ ¹æ®ä¼ å…¥çš„äº‹ä»¶åç§°çš„å‚æ•°ç»„è£…æˆ object</span>
    args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> event<span class="token punctuation">,</span> source<span class="token punctuation">:</span> <span class="token keyword">this</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// å¾ªç¯å­ç»„ä»¶</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> child <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    
    <span class="token comment">// åœ¨æ¯ä¸ªå­ç»„ä»¶ä¸­è°ƒç”¨ $emit è§¦å‘äº‹ä»¶</span>
    <span class="token keyword">var</span> shouldPropagate <span class="token operator">=</span> child<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    
    <span class="token comment">// åˆ¤æ–­è°ƒç”¨ $emit è¿”å›çš„å€¼æ˜¯å¦ä¸º true</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldPropagate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœè°ƒç”¨ $emit è¿”å›çš„å€¼ä¸º trueï¼Œå°±é€’å½’å­™å­ç»„ä»¶ç»§ç»­å¹¿æ’­</span>
      child<span class="token punctuation">.</span><span class="token function">$broadcast</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// æœ€åè¿”å›å½“å‰ç»„ä»¶çš„å®ä¾‹</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>element-ui å®ç°</strong></p></blockquote> <p><br>åœ¨ Element-UI ä¸­ï¼Œ$broadcast å®ç°çš„æºç æ”¾åœ¨Â /src/mixins/emitter.js æ–‡ä»¶ä¸­ï¼Œä»£ç å¾ˆç®€å•ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// å®šä¹‰ broadcast æ–¹æ³•ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šç»„ä»¶åç§°ã€å°†è¦è§¦å‘çš„äº‹ä»¶åç§°ã€å›è°ƒå‡½æ•°ä¼ é€’çš„å‚æ•°</span>
<span class="token keyword">function</span> <span class="token function">broadcast</span><span class="token punctuation">(</span><span class="token parameter">componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¾æ¬¡å¾ªç¯å½“å‰ç»„ä»¶çš„å­ç»„ä»¶</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–æ¯ä¸ªå­ç»„ä»¶çš„åå­—</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> child<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>componentName<span class="token punctuation">;</span>

    <span class="token comment">// åˆ¤æ–­å­ç»„ä»¶çš„åå­—æ˜¯å¦ç­‰äºä¼ å…¥çš„ç»„ä»¶åç§°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">===</span> componentName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœå­ç»„ä»¶çš„åå­—ç­‰äºä¼ å…¥çš„ç»„ä»¶åç§°å°±è°ƒç”¨ $emit è§¦å‘äº‹ä»¶</span>
      child<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœå­ç»„ä»¶çš„åå­—ä¸ç­‰äºä¼ å…¥çš„ç»„ä»¶åç§°å°±é€’å½’éå†è°ƒç”¨ broadcast å­™å­ç»„ä»¶</span>
      <span class="token function">broadcast</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">[</span>componentName<span class="token punctuation">,</span> eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>params<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><strong>å·®å¼‚åˆ†æ</strong></p></blockquote> <p><br>å’Œä¹‹å‰è¯´åˆ°çš„ $dispatch ä¸€æ ·ï¼Œè¿™é‡Œçš„ $broadcast çš„ä¸¤ä¸ªå®ç°ç‰ˆæœ¬ä¹Ÿå­˜åœ¨ç€å·¨å¤§çš„å·®å¼‚ï¼š</p> <ul><li><p>1ã€æ¥å—å‚æ•°ï¼šVue å®ç°ç‰ˆæœ¬åªä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„äº‹ä»¶åç§°ä¸ºå‚æ•°ï¼Œè€Œ element-ui å®ç°çš„ç‰ˆæœ¬ä¼šæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šéœ€è¦è§¦å‘äº‹ä»¶çš„ç»„ä»¶åç§°ã€å°†è¦è§¦å‘çš„äº‹ä»¶åç§°ã€å›è°ƒå‡½æ•°ä¼ é€’çš„å‚æ•°ï¼›</p></li> <li><p>2ã€å®ç°åŠŸèƒ½ï¼šVue å®ç°çš„Â $broadcastÂ è§¦å‘æ–¹å¼æ˜¯<strong>é»˜è®¤</strong>åªè§¦å‘å­ä»£ç»„ä»¶ï¼Œä¸è§¦å‘å­™å­ä»£ç»„ä»¶ï¼Œå¦‚æœå­ä»£åˆ›å»ºäº†ç›‘å¬ä¸”è¿”å›äº†trueï¼Œæ‰ä¼šå‘å­™å­ä»£ç»„ä»¶ä¼ é€’äº‹ä»¶ã€‚è€Œ element-ui å®ç°çš„ç‰ˆæœ¬æ˜¯ç›´æ¥å‘æ‰€æœ‰å­å­™åä»£ç»„ä»¶ä¼ é€’ï¼Œç›´è‡³è·å–åˆ°çš„å­ç»„ä»¶åç§°ç­‰äºä¼ å…¥çš„ç»„ä»¶åç§°ç›¸ç­‰ï¼Œæ‰ä¼šè§¦å‘å½“å‰å­ç»„ä»¶çš„ç›‘å¬äº‹ä»¶ï¼ŒæœŸé—´ä¹Ÿæ²¡æœ‰è¿”å›å€¼çš„åˆ¤å®šã€‚</p></li></ul> <p><a name="bbe8fac5"></a></p> <h2 id="_11-æ€»ç»“"><a href="#_11-æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> 11 æ€»ç»“</h2> <p>è¯´åˆ°è¿™é‡Œï¼Œ$dispatch å’ŒÂ $broadcast çš„è®²è§£å°±ç»“æŸäº†ã€‚å¯èƒ½å¤§å®¶å·²ç»çŸ¥é“äº† Vue 2.0 ç‰ˆæœ¬ä¸ºä»€ä¹ˆä¼šå°†è¿™ä¸¤ä¸ªå±æ€§ç§»é™¤ã€‚é¦–å…ˆæˆ‘ä»¬å¼•å…¥<a href="https://cn.vuejs.org/v2/guide/migration.html#dispatch-%E5%92%8C-broadcast-%E6%9B%BF%E6%8D%A2" target="_blank" rel="noopener noreferrer">å®˜ç½‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„è¯´æ³•ï¼š</p> <p><em>å› ä¸ºåŸºäºç»„ä»¶æ ‘ç»“æ„çš„äº‹ä»¶æµæ–¹å¼å®åœ¨æ˜¯è®©äººéš¾ä»¥ç†è§£ï¼Œå¹¶ä¸”åœ¨ç»„ä»¶ç»“æ„æ‰©å±•çš„è¿‡ç¨‹ä¸­ä¼šå˜å¾—è¶Šæ¥è¶Šè„†å¼±ã€‚è¿™ç§äº‹ä»¶æ–¹å¼ç¡®å®ä¸å¤ªå¥½ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›åœ¨ä»¥åè®©å¼€å‘è€…ä»¬å¤ªç—›è‹¦ã€‚å¹¶ä¸” <strong><code>$dispatch</code></strong>Â å’ŒÂ <strong><code>$broadcast</code></strong>Â ä¹Ÿæ²¡æœ‰è§£å†³å…„å¼Ÿç»„ä»¶é—´çš„é€šä¿¡é—®é¢˜ã€‚</em><br><br>è¿™æ ·æ¥è¯´Â $dispatch å’ŒÂ $broadcast ç¡®å®ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ã€‚åœ¨å‰é¢çš„è®²è§£ä¸­ï¼Œå¤§å®¶ä¹Ÿä¸éš¾å‘ç°Â $dispatch ä¸»è¦æ˜¯äº‹ä»¶æµç”±å½“å‰ç»„ä»¶å¾€çˆ¶ç»„ä»¶æµåŠ¨ï¼Œå½“æ»¡è¶³ä¸€å®šæ¡ä»¶çš„æ—¶å€™å°±ä¼šè§¦å‘å½“å‰å­ç»„ä»¶çš„ç›‘å¬äº‹ä»¶ï¼Œ$broadcast çš„åŠŸèƒ½æ˜¯äº‹ä»¶æµç”±å½“å‰ç»„ä»¶å‘å­ç»„ä»¶æµåŠ¨ï¼Œå½“æ»¡è¶³ä¸€å®šæ¡ä»¶çš„æ—¶å€™å°±ä¼šè§¦å‘å½“å‰å­ç»„ä»¶çš„ç›‘å¬äº‹ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´Â $dispatch å’ŒÂ $broadcast ä¸»è¦è§£å†³äº†çˆ¶å­ç»„ä»¶ã€åµŒå¥—çˆ¶å­ç»„ä»¶çš„é€šä¿¡ï¼Œå¹¶æ²¡æœ‰è§£å†³å…„å¼Ÿç»„ä»¶çš„é€šä¿¡é—®é¢˜ï¼Œå¦ä¸€ä¸ªæ–¹é¢è¿™æ ·çš„äº‹ä»¶æµåŠ¨çš„æ–¹å¼æ˜¯åŸºäºç»„ä»¶æ ‘ç»“æ„çš„ï¼Œå½“ä¸šåŠ¡è¶Šæ¥è¶Šçƒ¦æ‚æ—¶ï¼Œè¿™ç§æ–¹å¼ä¼šæ˜¾å¾—æå…¶ç¹çï¼Œç”šè‡³ä¼šæ··ä¹±åˆ°éš¾ä»¥ç»´æŠ¤ï¼Œæ‰€ä»¥ Vue 2.0 ç‰ˆæœ¬ç§»é™¤è¿™ä¸¤ä¸ª API æ˜¯åœ¨æ„æ–™ä¹‹ä¸­çš„ã€‚</p> <p>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸‰æ–¹ UI åº“éƒ½ä¼šå°è£…ç±»ä¼¼çš„è¿™æ ·ä¸€ä¸ªç»„ä»¶é€šä¿¡çš„æ–¹å¼å‘¢ï¼Ÿæˆ‘çš„çŒœæµ‹å¯èƒ½æ˜¯ä¸ºäº†è§£å†³åœ¨çˆ¶å­å±‚åµŒå¥—ç»„ä»¶ä¸­ï¼Œé€šè¿‡Â $dispatch å’ŒÂ $broadcast å®šå‘çš„å‘æŸä¸ªçˆ¶æˆ–è€…å­ç»„ä»¶<strong>è¿œç¨‹è°ƒç”¨</strong>äº‹ä»¶ï¼Œè¿™æ ·å°±é¿å…äº†é€šè¿‡ä¼  props æˆ–è€…ä½¿ç”¨ refs è°ƒç”¨ç»„ä»¶å®ä¾‹æ–¹æ³•çš„æ“ä½œã€‚è¿™æ ·è¯´çš„è¯ï¼Œ$dispatch å’ŒÂ $broadcast ä¹Ÿå°±å…¶å­˜åœ¨çš„ä»·å€¼ï¼Œè€Œå¹¶ä¸æ˜¯ä¸€æ— æ˜¯å¤„çš„ï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼š<strong>æŠ€æœ¯æ²¡æœ‰å¥½ä¸åï¼Œåªæœ‰åˆé€‚ä¸åˆé€‚</strong>ï¼</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/26/2019, 9:28:55 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/blog/Tools/Vue-0x01.html" class="prev">
          v-model å®ç°åŸç†
        </a></span> <span class="next"><a href="/blog/Tools/Vue-0x03.html">
          Vue v-model æºç è§£æ
        </a>
        â†’
      </span></p></div> <div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></div> <!----></div></div>
    <script src="/blog/assets/js/app.8628b115.js" defer></script><script src="/blog/assets/js/37.13db91e9.js" defer></script>
  </body>
</html>
