<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>回调函数详解 | LittleLane</title>
    <meta name="description" content="LittleLane的博客">
    <link rel="manifest" href="/blog/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.fb084c9e.css" as="style"><link rel="preload" href="/blog/assets/js/app.8628b115.js" as="script"><link rel="preload" href="/blog/assets/js/17.9ccc244d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.7c696101.js"><link rel="prefetch" href="/blog/assets/js/11.0789c73b.js"><link rel="prefetch" href="/blog/assets/js/12.461a1f52.js"><link rel="prefetch" href="/blog/assets/js/13.fe3225de.js"><link rel="prefetch" href="/blog/assets/js/14.90707970.js"><link rel="prefetch" href="/blog/assets/js/15.fe5adc74.js"><link rel="prefetch" href="/blog/assets/js/16.0ebb9344.js"><link rel="prefetch" href="/blog/assets/js/18.3280c375.js"><link rel="prefetch" href="/blog/assets/js/19.497df057.js"><link rel="prefetch" href="/blog/assets/js/2.a2883561.js"><link rel="prefetch" href="/blog/assets/js/20.32678c14.js"><link rel="prefetch" href="/blog/assets/js/21.1423f536.js"><link rel="prefetch" href="/blog/assets/js/22.f2e999a8.js"><link rel="prefetch" href="/blog/assets/js/23.ba5456dd.js"><link rel="prefetch" href="/blog/assets/js/24.506605c5.js"><link rel="prefetch" href="/blog/assets/js/25.a207ec0f.js"><link rel="prefetch" href="/blog/assets/js/26.2ef516a2.js"><link rel="prefetch" href="/blog/assets/js/27.0fc3d0a8.js"><link rel="prefetch" href="/blog/assets/js/28.857b9f54.js"><link rel="prefetch" href="/blog/assets/js/29.ddc54fa4.js"><link rel="prefetch" href="/blog/assets/js/3.03546f42.js"><link rel="prefetch" href="/blog/assets/js/30.d40e6ea0.js"><link rel="prefetch" href="/blog/assets/js/31.1195eb55.js"><link rel="prefetch" href="/blog/assets/js/32.8de16a5a.js"><link rel="prefetch" href="/blog/assets/js/33.7cd7fe57.js"><link rel="prefetch" href="/blog/assets/js/34.738f5bc5.js"><link rel="prefetch" href="/blog/assets/js/35.77dd47e7.js"><link rel="prefetch" href="/blog/assets/js/36.352ec5b1.js"><link rel="prefetch" href="/blog/assets/js/37.13db91e9.js"><link rel="prefetch" href="/blog/assets/js/38.c6fc1157.js"><link rel="prefetch" href="/blog/assets/js/39.8c2096af.js"><link rel="prefetch" href="/blog/assets/js/4.230e5792.js"><link rel="prefetch" href="/blog/assets/js/40.b2aa99ad.js"><link rel="prefetch" href="/blog/assets/js/41.b6c8edd8.js"><link rel="prefetch" href="/blog/assets/js/42.44ad0cc7.js"><link rel="prefetch" href="/blog/assets/js/43.fb6bd8dc.js"><link rel="prefetch" href="/blog/assets/js/44.f45a0bfd.js"><link rel="prefetch" href="/blog/assets/js/45.3ac2cc18.js"><link rel="prefetch" href="/blog/assets/js/46.763aa6cb.js"><link rel="prefetch" href="/blog/assets/js/47.949030e9.js"><link rel="prefetch" href="/blog/assets/js/48.54ad9db1.js"><link rel="prefetch" href="/blog/assets/js/5.e8583280.js"><link rel="prefetch" href="/blog/assets/js/6.34b724f6.js"><link rel="prefetch" href="/blog/assets/js/7.1c9ebf74.js"><link rel="prefetch" href="/blog/assets/js/8.928845ca.js"><link rel="prefetch" href="/blog/assets/js/9.aac799a8.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.fb084c9e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">LittleLane</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/AboutMe/" class="nav-link">关于我</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/AboutMe/" class="nav-link">关于我</a></div> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="carbon-ads"></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>JavaScript</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/JavaScript/0x00.html" class="sidebar-link">函数一等公民</a></li><li><a href="/blog/JavaScript/0x01.html" class="active sidebar-link">回调函数详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/JavaScript/0x01.html#回调函数定义" class="sidebar-link">回调函数定义</a></li><li class="sidebar-sub-header"><a href="/blog/JavaScript/0x01.html#回调函数原理" class="sidebar-link">回调函数原理</a></li><li class="sidebar-sub-header"><a href="/blog/JavaScript/0x01.html#回调函数作用域" class="sidebar-link">回调函数作用域</a></li><li class="sidebar-sub-header"><a href="/blog/JavaScript/0x01.html#多重回调与回调地狱" class="sidebar-link">多重回调与回调地狱</a></li></ul></li><li><a href="/blog/JavaScript/0x02.html" class="sidebar-link">高阶函数</a></li><li><a href="/blog/JavaScript/0x03.html" class="sidebar-link">重学 new 操作符</a></li><li><a href="/blog/JavaScript/0x04.html" class="sidebar-link">重学 call、apply</a></li><li><a href="/blog/JavaScript/0x05.html" class="sidebar-link">重学 bind</a></li><li><a href="/blog/JavaScript/0x06.html" class="sidebar-link">重学 Array 之基础概念</a></li><li><a href="/blog/JavaScript/0x07.html" class="sidebar-link">重学 Array 之元素增删</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DSA</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Node.js</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Tools</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/Tools/Vue-0x00.html" class="sidebar-link">Vue 组件通信详解</a></li><li><a href="/blog/Tools/Vue-0x01.html" class="sidebar-link">v-model 实现原理</a></li><li><a href="/blog/Tools/Vue-0x02.html" class="sidebar-link">Vue $dispatch 和 $broadcast</a></li><li><a href="/blog/Tools/Vue-0x03.html" class="sidebar-link">Vue v-model 源码解析</a></li><li><a href="/blog/Tools/Vue-0x04.html" class="sidebar-link">v-model 后续 input and change</a></li><li><a href="/blog/Tools/Vue-0x05.html" class="sidebar-link">Vue 生命周期详解</a></li><li><a href="/blog/Tools/Vue-0x06.html" class="sidebar-link">Vue.use() 做了什么？</a></li><li><a href="/blog/Tools/Vue-0x07.html" class="sidebar-link">Vue Router 实现剖析之一</a></li><li><a href="/blog/Tools/Vue-0x08.html" class="sidebar-link">Vue Router 实现剖析之二</a></li><li><a href="/blog/Tools/Vue-0x09.html" class="sidebar-link">Vue Router 实现剖析之三</a></li><li><a href="/blog/Tools/Vue-0x0A.html" class="sidebar-link">Vue Router 实现剖析之五</a></li><li><a href="/blog/Tools/Vue-0x0B.html" class="sidebar-link">数据响应式初探</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DailyQuestion</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/DailyQuestion/0x00.html" class="sidebar-link">['1', '2', '3'].map(parseInt)</a></li><li><a href="/blog/DailyQuestion/0x01.html" class="sidebar-link">git ssh Permission denied</a></li><li><a href="/blog/DailyQuestion/0x02.html" class="sidebar-link">0.1 + 0.2 !== 0.3</a></li><li><a href="/blog/DailyQuestion/0x03.html" class="sidebar-link">聊聊 a 标签 rel 属性值</a></li><li><a href="/blog/DailyQuestion/0x04.html" class="sidebar-link">浏览器路由 API 详解</a></li><li><a href="/blog/DailyQuestion/0x05.html" class="sidebar-link">VSCode nvm 问题</a></li><li><a href="/blog/DailyQuestion/0x06.html" class="sidebar-link">涉及 new 、this、以及原型链经典习题</a></li><li><a href="/blog/DailyQuestion/0x07.html" class="sidebar-link">DBeaver MySQL 问题集</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>BestPractices</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/" class="sidebar-link">Home</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>SafeOptimize</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog/SafeOptimize/0x00.html" class="sidebar-link">JavaScript 加载与执行</a></li><li><a href="/blog/SafeOptimize/0x01.html" class="sidebar-link">函数节流</a></li><li><a href="/blog/SafeOptimize/0x02.html" class="sidebar-link">XSS（Cross-Site Scripting）</a></li><li><a href="/blog/SafeOptimize/0x03.html" class="sidebar-link">CSRF(Cross-Site Request Forgery)</a></li><li><a href="/blog/SafeOptimize/0x04.html" class="sidebar-link">深入函数节流</a></li><li><a href="/blog/SafeOptimize/0x05.html" class="sidebar-link">js 异步加载之 async 和 defer</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="回调函数详解"><a href="#回调函数详解" aria-hidden="true" class="header-anchor">#</a> 回调函数详解</h1> <p><a name="8600eff8"></a></p> <h2 id="回调函数定义"><a href="#回调函数定义" aria-hidden="true" class="header-anchor">#</a> 回调函数定义</h2> <p>在<a href="https://www.yuque.com/littlelane/javascript/usizdp" target="_blank" rel="noopener noreferrer">函数一等公民<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>一节，我们详细介绍了函数一等公民的三大特性，这里我们再次强调一下：</p> <ul><li>函数可以赋值给变量</li> <li>函数可以作为另一个函数参数进行传递</li> <li>函数可以从子程序中进行返回</li></ul> <p>这一小节，我们详细的讲解一下_**函数****可以作为另一个函数参数进行传递 **_这一特性带来的一种函数编程模式 —— 回调函数。</p> <p>说实话，在我们的日常编程中，如果你是一名前端开发人员，回调函数是很常见的，形如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 我们利用 jQuery 给 id 属性值为 btn 的按钮注册一个点击事件</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// do something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 或者我们利用 node 的 fs api 读取一个文件</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'&lt;目录 url&gt;'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// =&gt; null, &lt;data&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>像上面的实例代码，我们随处可见！</p> <p>说了这么多，总结一句话：回调函数就是一个被作为参数传递给另一个函数的函数，这个函数会在接受参数的函数逻辑中被调用，本质上是一种函数编程的模式，因此，使用回调函数也叫做回调模式，常称其为 callback。</p> <p>回调函数使用场景有很多，比如做异步处理、切面编程、函数式编程等等，在 jQuery 中使用十分广泛。</p> <p><a name="1f975462"></a></p> <h2 id="回调函数原理"><a href="#回调函数原理" aria-hidden="true" class="header-anchor">#</a> 回调函数原理</h2> <p>上面的内容，我们对回调函数的形式、定义和使用场景大致有了一个基本的认识。那回调函数到底是怎么运行的呢？这里我们好好的来探究一下！</p> <p>假象有这样一个数组 [1, 2, 3, 4, 5]，我们通过遍历的方式将数组中的每个值乘以 2，最后返回新数组，<strong>注意后续可能会有不同的需求哟</strong>。当然通过 JavaScript 提供的很多工具函数都可以很好的完成，但是我们这里就要自己造一个。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 定义一个函数，接受需要处理的数组 origin 和一个定义处理逻辑的函数 callback</span>
<span class="token keyword">function</span> <span class="token function">myMap</span><span class="token punctuation">(</span><span class="token parameter">origin<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> newArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> origin<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	newArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">callback</span><span class="token punctuation">(</span>origin<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// 返回新的数组</span>
  <span class="token keyword">return</span> newArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 调用测试</span>
<span class="token function">myMap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 输出值</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
</code></pre></div><p>上面的实例代码，我们简单的实现了一个 myMap 函数，功能和现有的 Array 提供的 map 函数类似。接受两个参数，一个是需要处理的数组，另一个是处理逻辑的函数，也就是我们说的回调函数。当我们通过调用测试代码调用函数时，myMap 函数中会遍历需要处理的 origin 数组，然后针对每一个数组元素调用逻辑处理函数 callback，并将每次通过调用 callback 获取的值 push 到新的数组，最后当遍历完所有的数组元素时，返回新的数组。</p> <p>在这一个完整的逻辑中，逻辑处理函数 callback 针对每次 for 循环调用了，还可以通过 if-else 或 switch 等分支语句控制 callback 的调用。</p> <p>我们从中可以清晰的看到三点：</p> <ul><li>1、回调函数的调用和普通函数的调用方式是一样，都是通过函数名加 () 的形式；</li> <li>2、回调函数的传参和普通函数的传参也无二致，它依然可以在包含它的函数体内通过 arguments 对象获取参数；</li> <li>3、回调函数会在包含它的函数体内的某个特定时间点被“回调”（就像它的名字一样）；</li></ul> <p><a name="3579fe7a"></a></p> <h2 id="回调函数作用域"><a href="#回调函数作用域" aria-hidden="true" class="header-anchor">#</a> 回调函数作用域</h2> <p>回调函数作用域就要从函数作用域说起了。在 ES5 之前，JavaScript 只有全局作用域和函数作用域。</p> <ul><li>全局作用域指的是当前的窗口 window 作用域。在这里 ECMAScript 提供了很多底层实现的数据类型，方法和语法，构成了 JavaScript 语言体系。在非严格模式下，通过不带任何修饰符和带 var 关键字声明的变量，都会直接挂到全局 window 上。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 首先做一次验证操作，证明 window 下面没有声明 test 和 testVar 属性</span>
window<span class="token punctuation">.</span>test	<span class="token comment">// undefined</span>
window<span class="token punctuation">.</span>testVar	<span class="token comment">// undefined</span>

<span class="token comment">// 通过不添加任何修饰符和带 var 关键字分别声明变量并赋予值</span>
test <span class="token operator">=</span> <span class="token string">'lane'</span>
<span class="token keyword">var</span> testVar <span class="token operator">=</span> <span class="token string">'var lane'</span>

<span class="token comment">// 然后再次输出 window 下面的 test 和 testVar 属性值</span>
window<span class="token punctuation">.</span>test	<span class="token comment">// 'lane'</span>
window<span class="token punctuation">.</span>testVar	<span class="token comment">// 'var lane'</span>
</code></pre></div><p>但在严格模式下就有很大的不同了。不带任何修饰符声明变量就会无效，甚至会提示报错</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'use strict'</span>
myName <span class="token operator">=</span> <span class="token string">'lane'</span><span class="token punctuation">;</span>	<span class="token comment">// Uncaught ReferenceError: myName is not defined</span>
</code></pre></div><ul><li>函数作用域指的是声明一个函数而生成的作用域，居于全局作用域之中的一个单独的作用域。在这个作用域中可以访问外层的全局作用域，对外层作用域中的变量进行访问。</li></ul> <p><a name="83c01a79"></a></p> <h2 id="多重回调与回调地狱"><a href="#多重回调与回调地狱" aria-hidden="true" class="header-anchor">#</a> 多重回调与回调地狱</h2> <p>在早些年，回调函数盛行的时代，很多异步处理都是通过回调函数进行处理的。比如如果你熟悉 nodejs ，你肯定用过这种方式读取文件：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span>目录<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// do something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>那如果你有多个相互依赖的文件要按照顺序进行读取，也就是说，你只有在读取完上一个文件并获取到文件信息后，然后根据文件里面的信息，去读取下一个文件，依次类推，那你的代码就应该是多重回调的形式，会写成这样了：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span>目录<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// do something</span>
  fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span>目录<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span>目录<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// do something</span>
      <span class="token comment">// more read file operate</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样一种层层嵌套的回调形式就是我们俗称的回调地狱了。也许有人会问，这样的多重回调写法不是很清晰吗，为什么会被称为回调地狱呢？虽然长得有点丑！</p> <p>针对这样的疑问，我就自问自答一下吧！</p> <ul><li>大家听说的地狱肯定都是同一个地狱 —— 有 18 层。在这里，虽然代码我们不可能真正写 18 层的嵌套，但是这样的嵌套 3-4 层就会令人反感了；</li> <li>因为是层层依赖的关系（否则你不会这样嵌套着写），前一个回调获取的信息，在后一个处理中会被用到，那稍微有一层的逻辑要修改修改，其他层的逻辑是不是也会引起连锁反应，需要修改修改；</li> <li>其实嵌套一两层确实没什么关系，但是层数多一层，维护的成本就会增一个等级，牵一发而动全身，想想都是很恐怖的事情；</li> <li>理解成本成了回调地狱的另一个问题。回调函数嵌套越深，理解起来也会越费劲。因为在理解代码的时候，特别是这种嵌套性的代码，必须一行一行去解读，对于嵌套较深的代码，可能会看到后面的忘记了前面的代码逻辑是什么，无形中增加了代码理解的成本；</li></ul> <p>当然，回调函数也不是一无是处，每种技术模式、技术方案都有其存在的道理，回调函数也是一样的。适时、合理的使用回调函数的技能也会将代码写的很优雅，比如函数优化 —— 防抖和节流，setTimeout、setInterval 定时器的使用等等很多很多场景。最后还请大家使用辩证的眼光看待每一种技术吧！</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/28/2019, 8:54:14 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/JavaScript/0x00.html" class="prev">
          函数一等公民
        </a></span> <span class="next"><a href="/blog/JavaScript/0x02.html">
          高阶函数
        </a>
        →
      </span></p></div> <div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></div> <!----></div></div>
    <script src="/blog/assets/js/app.8628b115.js" defer></script><script src="/blog/assets/js/17.9ccc244d.js" defer></script>
  </body>
</html>
